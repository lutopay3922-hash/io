<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ë£¨íˆ¬í˜ì´</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&family=JetBrains_Mono:wght@400;700&display=swap');
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #0f0a1e;
            color: #f5f3ff;
            overflow-x: hidden;
        }
    </style>
</head>

<body class="min-h-screen">

<!-- ì‹¤ì‹œê°„ êµ¬ë§¤ ì˜ì—­ -->
<div class="fixed right-6 bottom-6 z-50">
    <div id="bottom-toast-container" class="flex flex-col space-y-3"></div>
</div>

<section class="max-w-xl mx-auto mt-20 px-6">
    <h2 class="text-2xl font-black mb-4">ì‹¤ì‹œê°„ êµ¬ë§¤ í˜„í™©</h2>
    <div id="live-purchase-container" class="space-y-3 max-h-[400px] overflow-y-auto"></div>
</section>

<!-- ================= Firebase ì‹¤ì‹œê°„ ì—°ë™ ================= -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
import {
  getFirestore,
  collection,
  query,
  orderBy,
  limit,
  onSnapshot
} from "https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore.js";

/* ğŸ”´ Firebase ì„¤ì •ê°’ (ë„¤ í”„ë¡œì íŠ¸ ê°’ìœ¼ë¡œ êµì²´) */
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  projectId: "YOUR_PROJECT_ID",
  storageBucket: "YOUR_PROJECT.appspot.com",
  messagingSenderId: "YOUR_SENDER_ID",
  appId: "YOUR_APP_ID"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const purchaseContainer = document.getElementById("live-purchase-container");
const toastContainer = document.getElementById("bottom-toast-container");

/* ğŸ”¥ Firestore ì‹¤ì‹œê°„ êµ¬ë… */
const q = query(
  collection(db, "livePurchases"),
  orderBy("createdAt", "desc"),
  limit(50)
);

onSnapshot(q, (snapshot) => {
  purchaseContainer.innerHTML = "";

  snapshot.forEach((doc) => {
    const data = doc.data();
    renderPurchase(data.name, data.card, data.amount);
  });
});

/* êµ¬ë§¤ ì¹´ë“œ ë Œë” */
function renderPurchase(name, card, amount) {
  const el = document.createElement("div");
  el.className =
    "flex items-center justify-between p-3 bg-white/5 border border-white/10 rounded-xl";

  el.innerHTML = `
    <div>
      <p class="text-sm font-bold">${name}</p>
      <p class="text-xs text-white/50">${card}</p>
    </div>
    <span class="text-sm font-black text-cyan-400">${amount}</span>
  `;

  purchaseContainer.appendChild(el);
  showToast(name, card, amount);
}

/* í† ìŠ¤íŠ¸ ì•Œë¦¼ */
function showToast(name, card, amount) {
  const toast = document.createElement("div");
  toast.className =
    "flex items-center space-x-3 px-4 py-3 bg-[#1a142e] border border-purple-500/30 rounded-xl shadow-lg";

  toast.innerHTML = `
    <i class="fas fa-check text-purple-400"></i>
    <div>
      <p class="text-xs font-bold">${name} êµ¬ë§¤ ì™„ë£Œ</p>
      <p class="text-[10px] text-white/40">${card} Â· ${amount}</p>
    </div>
  `;

  toastContainer.appendChild(toast);
  setTimeout(() => toast.remove(), 3500);
}
</script>
<!-- ======================================================= -->

</body>
</html>
