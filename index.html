<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë©”ì¸ í˜ì´ì§€</title>
</head>
<body>

<h1 id="bannerTitle">ë¡œë”©ì¤‘...</h1>
<p id="bannerDesc"></p>

<hr>

<h2>ì£¼ë¬¸í•˜ê¸°</h2>
<p id="productName">í…ŒìŠ¤íŠ¸ ìƒí’ˆ</p>
<p id="productPrice">10000</p>

<input id="buyerName" placeholder="ì´ë¦„">
<input id="buyerPhone" placeholder="íœ´ëŒ€í° ë²ˆí˜¸">
<textarea id="orderMemo" placeholder="ë©”ëª¨"></textarea>
<br><br>
<button onclick="createOrder()">ì£¼ë¬¸í•˜ê¸°</button>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, doc, onSnapshot, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "ì—¬ê¸°ì—_API_KEY",
  authDomain: "zcash-web.firebaseapp.com",
  projectId: "zcash-web",
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

/* ğŸ”´ ì‹¤ì‹œê°„ ë°ì´í„° ìˆ˜ì‹  */
onSnapshot(doc(db, "siteData", "main"), (docSnap) => {
  if (docSnap.exists()) {
    const d = docSnap.data();
    document.getElementById("bannerTitle").innerText = d.title || "";
    document.getElementById("bannerDesc").innerText = d.desc || "";
  }
});

/* ğŸ”´ ì£¼ë¬¸ ìƒì„± */
window.createOrder = async function () {
  const orderNo = "ORD-" + Date.now();

  await addDoc(collection(db, "orders"), {
    orderNo,
    product: document.getElementById("productName").innerText,
    price: 10000,
    buyer: document.getElementById("buyerName").value,
    phone: document.getElementById("buyerPhone").value,
    memo: document.getElementById("orderMemo").value,
    status: "ì…ê¸ˆëŒ€ê¸°",
    createdAt: serverTimestamp()
  });

  alert(
`ì£¼ë¬¸ì´ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤.

ì£¼ë¬¸ë²ˆí˜¸: ${orderNo}

ì…ê¸ˆ í›„ ì£¼ë¬¸ë²ˆí˜¸ë¥¼ ë‚¨ê²¨ì£¼ì„¸ìš”.`
  );
};
</script>

</body>
</html>
